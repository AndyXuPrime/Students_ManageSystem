server:
  port: 8080 # 网关端口，前端所有请求都发给这个端口

spring:
  application:
    name: stu-gateway-dev
  cloud:
    nacos:
      discovery:
        server-addr: localhost:8848

    gateway:
      discovery:
        locator:
          enabled: true
          lower-case-service-id: true

      routes:
        - id: sims-service-route

          uri: lb://studentmanage-test
          predicates:
            - Path=/api/**                    # 断言：路径以 /api 开头的请求都拦截
          filters:
            - StripPrefix=1                   # 过滤器：去掉第1层前缀 (即去掉 /api)
            # 举例：前端请求 /api/auth/captcha -> 网关转发给 sims-service 的 /auth/captcha

      # ==========================
      # 跨域配置 (CORS) - 解决 Vue 跨域问题
      # ==========================
      globalcors:
        cors-configurations:
          '[/**]':
            allowedOrigins: "*"               # 允许所有来源 (生产环境建议指定具体域名)
            allowedMethods: "*"               # 允许所有方法 (GET, POST, PUT, DELETE...)
            allowedHeaders: "*"               # 允许所有请求头
            allowCredentials: false           # 是否允许携带 Cookie (设为 true 时 allowedOrigins 不能为 *)